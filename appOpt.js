(()=>{const e=document.querySelector("canvas"),t=document.getElementById("backdrop"),n=document.getElementById("modal"),r=document.getElementById("current-score"),i=document.getElementById("high-score"),s=document.getElementById("trophy"),o=document.querySelector("button"),c=e.getContext("2d"),l=10,a=20,d="right",h="left",m="up",u="down";let y,g=!1,f=0;const I=new Image;I.src="apple.png";class k{constructor(e,t,n){this.initLen=e,this.color=t,this.direction=n,this.newDir=n,this.create()}create(){this.cells=[];for(let e=this.initLen;e>0;e--)this.cells.push({x:e,y:7})}draw(){c.clearRect(0,0,300,150),c.drawImage(I,y.x*a,y.y*l,19,9.5),c.fillStyle=this.color;for(const e of this.cells)c.fillRect(e.x*a,e.y*l,19.5,9.5);const e=this.cells[0].x,t=this.cells[0].y;c.strokeStyle="white",c.beginPath(),this.direction===d?(c.arc(e*a+15,t*l+2,2,0,2*Math.PI),c.stroke(),c.beginPath(),c.arc(e*a+15,t*l+6,2,0,2*Math.PI)):this.direction===h?(c.arc(e*a+5,t*l+2,2,0,2*Math.PI),c.stroke(),c.beginPath(),c.arc(e*a+5,t*l+6,2,0,2*Math.PI)):this.direction===m?(c.arc(e*a+7,t*l+4,2.2,0,2*Math.PI),c.stroke(),c.beginPath(),c.arc(e*a+13,t*l+4,2.2,0,2*Math.PI)):(c.arc(e*a+7,t*l+6,2.2,0,2*Math.PI),c.stroke(),c.beginPath(),c.arc(e*a+13,t*l+6,2.2,0,2*Math.PI)),c.stroke()}}function p(e){if(e.direction!=e.newDir&&function(e){const t=e.direction,n=e.newDir;(n===m&&t!==u||n===u&&t!==m||n===d&&t!==h||n===h&&t!==d)&&(e.direction=n)}(e),function(e){const t=e.direction,n=e.cells[0].x,r=e.cells[0].y;return t===d&&(n+1>14||e.cells.find((e=>{if(e.x===n+1&&e.y===r)return!0})))||t===h&&(n-1<0||e.cells.find((e=>{if(e.x===n-1&&e.y===r)return!0})))||t===m&&(r-1<0||e.cells.find((e=>{if(e.x===n&&e.y===r-1)return!0})))||t===u&&(r+1>14||e.cells.find((e=>{if(e.x===n&&e.y===r+1)return!0})))}(e))return e.color="red",e.draw(),void(g=!0);const t=e.cells[0].x,n=e.cells[0].y,i=e.direction;i===d?e.cells.unshift({x:t+1,y:n}):i===h?e.cells.unshift({x:t-1,y:n}):i===m?e.cells.unshift({x:t,y:n-1}):i===u&&e.cells.unshift({x:t,y:n+1}),t===y.x&&n===y.y?(y=w(e),f++):e.cells.pop(),r.innerHTML=`${f}`}function w(e){const t=Math.round(280*Math.random()/a),n=Math.round(140*Math.random()/l);return e.cells.length>0&&e.cells.find((e=>{if(e.x===t&&e.y===n)return!0}))?w(e):{x:t,y:n}}function P(e){if(g){setTimeout((()=>{c.clearRect(0,0,300,150)}),1700),clearInterval(gameOnLoop),clearInterval(moveSnake);const e=localStorage.getItem("snakeGame3917");return(!e||f>+e)&&localStorage.setItem("snakeGame3917",`${f}`),void function(){const e=document.getElementById("modal-curr-score"),t=document.getElementById("modal-high-score");e.innerHTML=`<img src="apple.png" alt="" />&emsp;&emsp;&emsp;${f}`,t.innerHTML='<img src="trophy.png" alt="" />&emsp;&emsp;&emsp;'+ +localStorage.getItem("snakeGame3917"),b(),o.addEventListener("click",M)}()}console.log("running..."),e.draw()}function x(e,t){keyPressed=t.key,g?" "===keyPressed&&M():"q"===keyPressed||"Q"===keyPressed?g=!0:"ArrowUp"===keyPressed?e.newDir=m:"ArrowDown"===keyPressed?e.newDir=u:"ArrowLeft"===keyPressed?e.newDir=h:"ArrowRight"===keyPressed&&(e.newDir=d)}function v(){const e=new k(4,"#012a87",d);y=w(e),g=!1,f=0,gameOnLoop=setInterval(P.bind(this,e),20),moveSnake=setInterval(p.bind(this,e),189),document.addEventListener("keydown",x.bind(this,e)),+localStorage.getItem("snakeGame3917")>0&&(s.style.visibility="visible",i.style.visibility="visible",i.innerHTML=""+ +localStorage.getItem("snakeGame3917"))}function b(){n.classList.toggle("visible"),t.classList.toggle("visible")}function M(){b(),v()}v()})();